{"version":3,"file":"skip-link.mjs","sources":["../../../../src/govuk/components/skip-link/skip-link.mjs"],"sourcesContent":["import { ElementError } from '../../errors/index.mjs'\nimport { GOVUKFrontendComponent } from '../../govuk-frontend-component.mjs'\n\n/**\n * Skip link component\n *\n * @preserve\n */\nexport class SkipLink extends GOVUKFrontendComponent {\n  /** @private */\n  $module\n\n  /** @private */\n  $linkedElement\n\n  /** @private */\n  linkedElementListener = false\n\n  /**\n   * @param {Element} $module - HTML element to use for skip link\n   * @throws {ElementError} when $module is not set or the wrong type\n   * @throws {ElementError} when $module.hash does not contain a hash\n   * @throws {ElementError} when the linked element is missing or the wrong type\n   */\n  constructor($module) {\n    super()\n\n    if (!($module instanceof HTMLAnchorElement)) {\n      throw new ElementError($module, {\n        componentName: 'Skip link',\n        identifier: '$module',\n        expectedType: HTMLAnchorElement\n      })\n    }\n\n    this.$module = $module\n    this.$linkedElement = this.getLinkedElement()\n\n    this.$module.addEventListener('click', () => this.focusLinkedElement())\n  }\n\n  /**\n   * Get linked element\n   *\n   * @private\n   * @returns {HTMLElement} $linkedElement - DOM element linked to from the skip link\n   */\n  getLinkedElement() {\n    const linkedElementId = this.getFragmentFromUrl(this.$module.hash)\n\n    // Check for link hash fragment\n    if (!linkedElementId) {\n      throw new ElementError(this.$module, {\n        componentName: 'Skip link',\n        identifier: '$module.hash',\n        expectedType: 'string'\n      })\n    }\n\n    const $linkedElement = document.getElementById(linkedElementId)\n\n    // Check for link target element\n    if (!($linkedElement instanceof HTMLElement)) {\n      throw new ElementError($linkedElement, {\n        componentName: 'Skip link',\n        identifier: `$module.hash target #${linkedElementId}`\n      })\n    }\n\n    return $linkedElement\n  }\n\n  /**\n   * Focus the linked element\n   *\n   * Set tabindex and helper CSS class. Set listener to remove them on blur.\n   *\n   * @private\n   */\n  focusLinkedElement() {\n    if (!this.$linkedElement.getAttribute('tabindex')) {\n      // Set the element tabindex to -1 so it can be focused with JavaScript.\n      this.$linkedElement.setAttribute('tabindex', '-1')\n      this.$linkedElement.classList.add('govuk-skip-link-focused-element')\n\n      // Add listener for blur on the focused element (unless the listener has previously been added)\n      if (!this.linkedElementListener) {\n        this.$linkedElement.addEventListener('blur', () =>\n          this.removeFocusProperties()\n        )\n        this.linkedElementListener = true\n      }\n    }\n\n    this.$linkedElement.focus()\n  }\n\n  /**\n   * Remove the tabindex that makes the linked element focusable because the element only needs to be\n   * focusable until it has received programmatic focus and a screen reader has announced it.\n   *\n   * Remove the CSS class that removes the native focus styles.\n   *\n   * @private\n   */\n  removeFocusProperties() {\n    this.$linkedElement.removeAttribute('tabindex')\n    this.$linkedElement.classList.remove('govuk-skip-link-focused-element')\n  }\n\n  /**\n   * Get fragment from URL\n   *\n   * Extract the fragment (everything after the hash) from a URL, but not including\n   * the hash.\n   *\n   * @private\n   * @param {string} url - URL\n   * @returns {string | undefined} Fragment from URL, without the hash\n   */\n  getFragmentFromUrl(url) {\n    if (url.indexOf('#') === -1) {\n      return undefined\n    }\n\n    return url.split('#').pop()\n  }\n\n  /**\n   * Name for the component used when initialising using data-module attributes.\n   */\n  static moduleName = 'govuk-skip-link'\n}\n"],"names":["SkipLink","GOVUKFrontendComponent","constructor","$module","$linkedElement","linkedElementListener","HTMLAnchorElement","ElementError","componentName","identifier","expectedType","getLinkedElement","addEventListener","focusLinkedElement","linkedElementId","getFragmentFromUrl","hash","document","getElementById","HTMLElement","getAttribute","setAttribute","classList","add","removeFocusProperties","focus","removeAttribute","remove","url","indexOf","undefined","split","pop","moduleName"],"mappings":"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"}