name: Build

runs:
  using: composite

  steps:
    - name: Cache build
      uses: actions/cache@v3
      id: build-cache

      with:
        # Restore build cache (unless commit SHA changes)
        key: build-cache-${{ github.sha }}
        path: |
          dist
          jsdoc
          package
          public
          sassdoc

    - name: Install dependencies
      uses: ./.github/workflows/actions/install-node

    - name: Build
      id: build

      # Skip build when weâ€™ve built this SHA before
      if: steps.build-cache.outputs.cache-hit != 'true'
      shell: bash
      run: |
        npm run build:compile
        npm run build:package
        npm run build:dist
